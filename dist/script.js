var production;function renderPie(t){var o=Math.min(450,450)/2-40;d3.select("#pie-share").select("svg").remove();var e=d3.select("#pie-share").append("svg").attr("width",450).attr("height",450).append("g").attr("transform","translate(225,225)"),r={nuclear:parseFloat(production[t].nuclear),fossil:parseFloat(production[t].fossil),gas:parseFloat(production[t].gas),oil:parseFloat(production[t].oil),renewable:parseFloat(production[t].renewable),other:parseFloat(production[t].other)},n=d3.scaleOrdinal().domain(r).range(d3.schemeSet2),a=d3.pie().value(function(t){return t.value})(d3.entries(r)),d=d3.arc().innerRadius(0).outerRadius(o);e.selectAll("mySlices").data(a).enter().append("path").attr("d",d).attr("fill",function(t){return n(t.data.key)}).attr("stroke","black").style("stroke-width","2px").style("opacity",.7),e.selectAll("mySlices").data(a).enter().append("text").text(function(t){return"grp "+t.data.key}).attr("transform",function(t){return"translate("+d.centroid(t)+")"}).style("text-anchor","middle").style("font-size",17)}function showCountry(){$(".svg").load($(".svg").data("file"),function(){$("path.eu").click(function(){var t;console.log($(this)),console.log($(this).attr("id")),$(this).hasClass("selected")?($(this).removeClass("selected"),t="eu"):($("path.eu").removeClass("selected"),$(this).addClass("selected"),t=$(this).attr("id")),window.history.replaceState("",document.title,window.location.href.replace(location.hash,"")+t),$("#country-title").html(production[t].name),$("#nav-country .flag").attr("src","img/flags/"+t+".svg");var o=$("<td>"+production[t][2007]+"</td>"),e=$("<td>"+production[t][2017]+"</td>"),r=$("<tr></tr>").append(o,e);$("#table-years tbody").html(r);var n=$("<td>"+production[t].nuclear+"</td>"),a=$("<td>"+production[t].fossil+"</td>"),d=$("<td>"+production[t].gas+"</td>"),i=$("<td>"+production[t].oil+"</td>"),l=$("<td>"+production[t].renewable+"</td>"),s=$("<td>"+production[t].other+"</td>"),c=$("<tr></tr>").append(n,a,d,i,l,s);$("#table-share tbody").html(c),renderPie(t)})})}function showData(){$.each(production,function(t){var o=$("<img src='img/flags/"+t+".svg' alt='"+production[t].name+"' class='flag'>"),e=$("<td></td>").append(o," ",production[t].name),r=$("<td>"+production[t][2007]+"</td>"),n=$("<td>"+production[t][2017]+"</td>"),a=$("<td>"+production[t].nuclear+"</td>"),d=$("<td>"+production[t].fossil+"</td>"),i=$("<td>"+production[t].gas+"</td>"),l=$("<td>"+production[t].oil+"</td>"),s=$("<td>"+production[t].renewable+"</td>"),c=$("<td>"+production[t].other+"</td>"),u=$("<tr></tr>").append(e,r,n,a,d,i,l,s,c);"eu"===t?$("#table-production tfoot").append(u):$("#table-production tbody").append(u)})}function run(){$(document).ready(function(){console.log(production),showCountry(),showData(),$("#cz").tooltip({title:"This will show in absence of title attribute."}),$("#cz").tooltip("show")})}$.getJSON("data/numbers.json",function(t){production=t}).done(function(){run()}).fail(function(){console.log("error")});